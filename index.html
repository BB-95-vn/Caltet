<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Pangolin&family=Playball&display=swap" rel="stylesheet">
  <title>Tra Âm → Dương • Can Chi • Tứ Hóa • Tiết Khí</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body class="tet">
  <div class="falling-container">
    <div class="flower">❀</div>
    <div class="flower">✿</div>
    <div class="flower">❀</div>
    <div class="flower">✿</div>
    <div class="flower">❀</div>
    <div class="flower">✿</div>
    <div class="flower">❀</div>
</div>
  <div class="wrap">
    <header class="header">
      <div class="title">Tra Âm → Dương</div>
      <div class="subtitle">Xuất Can Chi (năm/tháng/ngày) + Tứ Hóa + Tiết khí gần nhất (bỏ trung khí) + Zodiac</div>

      <div class="themeRow">
        <label class="themeSwitch" title="Bật/tắt giao diện Tết (lưu trên máy)">
          <input id="themeToggle" type="checkbox" checked />
          <span class="slider" aria-hidden="true"></span>
          <span class="themeText"><span class="on">Tết</span><span class="off">Classic</span></span>
        </label>
      </div>
      <div class="status" id="status">Đang tải dữ liệu…</div>
    </header>

    <section class="card">
      <div class="tabs" role="tablist" aria-label="Chọn chế độ tra cứu">
        <button id="tabLunar" class="tab active" type="button">Tra ÂM → DƯƠNG</button>
        <button id="tabSolar" class="tab" type="button">Tra DƯƠNG → ÂM</button>
      </div>

      <!-- Panel: Lunar -> Solar -->
      <div id="panelLunar">
        <div class="grid">
          <label class="field">
            <span>Ngày âm</span>
            <input id="amDay" type="number" inputmode="numeric" min="1" max="30" placeholder="1..30" />
          </label>
          <label class="field">
            <span>Tháng âm</span>
            <input id="amMonth" type="number" inputmode="numeric" min="1" max="12" placeholder="1..12" />
          </label>
          <label class="field">
            <span>Năm âm</span>
            <input id="amYear" type="number" inputmode="numeric" min="1900" max="2100" placeholder="VD 2026" />
          </label>
        </div>

        <div class="row">
          <label class="check">
            <input id="amLeap" type="checkbox" />
            <span>Tháng nhuận (N)</span>
          </label>

          <label class="field tz">
            <span>Vùng giờ (tính tiết khí)</span>
            <select id="tz">
              <option value="Asia/Ho_Chi_Minh">VN (Asia/Ho_Chi_Minh)</option>
              <option value="Asia/Seoul">KR (Asia/Seoul)</option>
              <option value="Asia/Tokyo">JP (Asia/Tokyo)</option>
              <option value="Asia/Shanghai">CN (Asia/Shanghai)</option>
              <option value="UTC">UTC</option>
            </select>
          </label>
        </div>
      </div>

      <!-- Panel: Solar -> Lunar -->
      <div id="panelSolar" style="display:none;">
        <label class="field" style="margin-top:6px;">
          <span>Ngày dương</span>
          <input id="solarDate" type="date" />
        </label>

        <div class="row" style="margin-top:10px;">
          <label class="field tz">
            <span>Vùng giờ (tính tiết khí)</span>
            <select id="tz2">
              <option value="Asia/Ho_Chi_Minh">VN (Asia/Ho_Chi_Minh)</option>
              <option value="Asia/Seoul">KR (Asia/Seoul)</option>
              <option value="Asia/Tokyo">JP (Asia/Tokyo)</option>
              <option value="Asia/Shanghai">CN (Asia/Shanghai)</option>
              <option value="UTC">UTC</option>
            </select>
          </label>
        </div>
      </div>

      <button id="btn" class="btn" disabled>Tra cứu</button>

      <div class="hint">
        Nếu web “kẹt tải dữ liệu”, hãy kiểm tra folder <b>data/</b> có đúng 2 file CSV và mở bằng GitHub Pages (không mở bằng <b>file://</b>).
      </div>
    </section>

    <section class="card" id="outCard" style="display:none;">
      <div id="out" class="out"></div>
    </section>

    <footer class="footer">
      Data: 2000–2100 tiết khí (4 zones + UTC) • Âm lịch đã normalize (≈56k dòng)
    </footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="app.js?v=10"></script>
</body>
</html>
